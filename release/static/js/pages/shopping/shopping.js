global.webpackJsonp([3],{Mydx:function(t,s){},P8b3:function(t,s,e){"use strict";var i={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("zan-popup",{attrs:{type:"bottom",show:t.visible,mpcomid:"0"}},[e("div",{staticClass:"sku"},[e("div",{staticClass:"sku-content"},[e("div",{staticClass:"goods"},[e("div",{staticClass:"goods-img"},[e("img",{attrs:{src:t.goods.image,mode:"aspectFill"}})]),t._v(" "),e("div",{staticClass:"goods-cont"},[e("div",{staticClass:"goods-cont__price"},[e("span",{staticClass:"goods-cont__price--default"},[t._v("￥"+t._s(t.goods.sellPrice))]),t._v(" "),t.goods.ping&&t.goods.ping.price?e("span",{staticClass:"goods-cont__price--group"},[t._v("拼团价:￥"+t._s(t.goods.ping.price))]):t._e()]),t._v(" "),e("p",{staticClass:"pop_title zan-ellipsis",domProps:{textContent:t._s(t.goods.name)}}),t._v(" "),e("div",{staticClass:"van-sku__close-icon van-icon van-icon-close",attrs:{eventid:"0"},on:{click:t.handleToggle}})],1)]),t._v(" "),e("scroll-view",{staticClass:"sku-content--scroll",attrs:{"scroll-y":""}},[e("div",{staticClass:"kuang_2"},[e("p",{staticClass:"k2_title"},[t._v("颜色")]),t._v(" "),e("div",{staticClass:"k2_btnk"},t._l(t.skuAttr,function(s,i){return e("span",{key:i,staticClass:"k2_btn",class:{active:i===t.colorIndex},attrs:{eventid:"1-"+i},on:{click:function(e){t.selectColorSpec(i,s.colorVal)}}},[e("i",[t._v(t._s(s.colorVal))]),t._v(" "),e("strong",{directives:[{name:"show",rawName:"v-show",value:s.sizeNums,expression:"item.sizeNums"}],staticClass:"counts"},[t._v(t._s(s.sizeNums))])],1)}))],1),t._v(" "),e("div",{staticClass:"kuang_3"},[e("ul",{staticClass:"s_item_box box1"},[e("li",{staticClass:"s_item"},[t._v("尺码")]),t._v(" "),e("li",{staticClass:"s_item"},[t._v("购买数量")])],1),t._v(" "),t._l(t.skuAttr[t.colorIndex]?t.skuAttr[t.colorIndex].sizeArray:[],function(s,i){return e("ul",{key:i,staticClass:"s_item_box"},[e("li",{staticClass:"s_item"},[t._v(t._s(s.sizeVal))]),t._v(" "),e("li",{staticClass:"s_item"},[e("span",{staticClass:"minus",attrs:{eventid:"2-"+i},on:{click:function(s){t.handleMinusClick(t.colorIndex,i)}}}),t._v(" "),e("span",{staticClass:"count"},[t._v(t._s(s.sizeNum))]),t._v(" "),e("span",{staticClass:"add",attrs:{eventid:"3-"+i},on:{click:function(s){t.handleAddClick(t.colorIndex,i)}}})])],1)})],2),t._v(" "),e("div",{staticClass:"kuang_4"},[e("p",{staticClass:"k4_title"},[t._v("已选")]),t._v(" "),t._l(t.sku,function(s,i){return e("p",{key:i,staticClass:"k4_text"},[t._v(t._s(s.colorVal)+"："),t._l(s.sizeArray,function(s,i){return e("span",{key:i},[t._v(t._s(s.sizeVal)+"/"+t._s(s.sizeNum)+"件;")])})],2)})],2)]),t._v(" "),e("div",{staticClass:"sku-footer"},[e("span",{staticClass:"sku-footer__btn",attrs:{eventid:"4"},on:{click:function(s){t.handleConfirmClick()}}},[t._v("确定")])])],1)])])},staticRenderFns:[]};s.a=i},PqIK:function(t,s,e){"use strict";var i=e("srTx"),a=e("hKlP");var n=function(t){e("pIgo")},c=e("ybqe")(i.a,a.a,n,"data-v-24926e6a",null);s.a=c.exports},Ygzb:function(t,s,e){"use strict";var i=e("iZoB");s.a={props:{visible:{type:Boolean,default:!1},goods:{type:Object,default:function(){}},sku:{type:Array,default:function(){return[]}}},watch:{sku:function(t){this.skuAttr=Object(i.a)(t)}},data:function(){return{colorIndex:0,skuAttr:[],hasAction:!1}},methods:{handleToggle:function(){this.$emit("value",!1)},handleMinusClick:function(t,s){if(0===this.skuAttr[t].sizeArray[s].sizeNum)return!1;this.skuAttr[t].sizeArray[s].sizeNum--,this.hasAction=!0,this.skuAttr[t].sizeNums--},handleAddClick:function(t,s){if(this.skuAttr[t].sizeArray[s].sizeNum>=100)return!1;this.skuAttr[t].sizeArray[s].sizeNum++,this.hasAction=!0,this.skuAttr[t].sizeNums++},handleConfirmClick:function(){this.$emit("confirm",this.skuAttr,this.sku),this.handleToggle()},selectColorSpec:function(t){this.colorIndex=t}}}},hKlP:function(t,s,e){"use strict";var i={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"nav"},[t.kong?e("div",{staticClass:"kong"},[e("img",{staticClass:"k_img",attrs:{src:"../../assets/img/shopping/kgwc.png"}}),t._v(" "),e("p",{staticClass:"k_text"},[t._v("你的购物车还没有商品~")]),t._v(" "),e("span",{staticClass:"k_btn",attrs:{eventid:"0"},on:{click:function(s){t.toHome()}}},[t._v("去首页逛逛吧")])],1):e("div",{staticClass:"content"},[e("div",{staticClass:"head"},[e("div",{staticClass:"head__hd"},[e("i",{staticClass:"xz",class:{active:t.checkAll},attrs:{eventid:"1"},on:{click:function(s){t.clickCheckAll()}}}),t._v(" "),e("span",{staticClass:"h1_text",attrs:{eventid:"2"},on:{click:function(s){t.clickCheckAll()}}},[t._v("全选")])],1),t._v(" "),e("div",{staticClass:"head__bd"},[t.showBtn?e("i",{staticClass:"sc",attrs:{eventid:"4"},on:{click:function(s){t.deleteBtn()}}}):e("span",{attrs:{eventid:"3"},on:{click:function(s){t.delBtn()}}},[t._v("完成")])],1)]),t._v(" "),e("div",{staticClass:"kuang"},[e("div",{staticClass:"k_head"},[e("div",{staticClass:"kh_text"},[t._v(t._s(t.shopName))])]),t._v(" "),t._l(t.cardList,function(s,i){return e("div",{key:i,staticClass:"k_content"},[e("div",{staticClass:"item_1",attrs:{eventid:"5-"+i},on:{click:function(e){t.clickCheck(s.id,i)}}},[e("i",{staticClass:"kc_xz",class:{active:s.check}})],1),t._v(" "),e("div",{staticClass:"item_2"},[s.image?e("img",{staticClass:"kc_img",attrs:{src:s.image,mode:"aspectFill"}}):e("img",{staticClass:"kc_img",attrs:{src:"http://www.qckj.link/upload/goods/20180520/1526794348353_160563.jpg"}})]),t._v(" "),e("div",{staticClass:"item_3"},[e("p",{staticClass:"i_title",domProps:{textContent:t._s(s.name)}}),t._v(" "),t._l(s.skuCode,function(s,i){return e("p",{key:i,staticClass:"uniform"},[t._v(t._s(s))])}),t._v(" "),e("p",{staticClass:"money"},[t._v("¥"+t._s(s.sellPrice))]),t._v(" "),e("span",{staticClass:"quantity"},[t._v("x"+t._s(s.totalNum))]),t._v(" "),e("span",{staticClass:"btn",attrs:{eventid:"6-"+i},on:{click:function(s){t.editOrder(i)}}},[t._v("编辑")])],2)])})],2),t._v(" "),e("div",{staticClass:"settlement-fixed"},[e("div",{staticClass:"settlement"},[t.showBtn?e("span",{staticClass:"s_btn",attrs:{eventid:"7"},on:{click:function(s){t.Buy()}}},[t._v("结算("+t._s(t.selectArr.length)+")")]):t._e(),t._v(" "),t.showBtn?t._e():e("span",{staticClass:"s_del",attrs:{eventid:"8"},on:{click:function(s){t.deleteBtn()}}},[t._v("删除("+t._s(t.selectArr.length)+")")])])]),t._v(" "),e("i-modal",{attrs:{visible:t.visible2,eventid:"9",mpcomid:"0"},on:{ok:function(s){t.delCard()},cancel:function(s){t.visible2=!1}}},[e("div",{staticClass:"m_tips"},[t._v("确定删除商品")])])],1),t._v(" "),e("sku",{attrs:{goods:t.sku.goods,sku:t.sku.sku,visible:t.visible,eventid:"10",mpcomid:"1"},on:{value:t.handleToggle,confirm:t.handleUpdate}})],1)},staticRenderFns:[]};s.a=i},pIgo:function(t,s){},srTx:function(t,s,e){"use strict";var i=e("Xxa5"),a=e.n(i),n=e("exGp"),c=e.n(n),r=e("qTHA"),o=e("xzGo"),l=(e("QmSG"),e("uJxD")),u=e("Zm3I");s.a={components:{sku:l.a},data:function(){return{shopName:"",visible:!1,sessionId:"",kong:!0,showBtn:!0,msg:"",count:0,popup:!1,value1:1,value2:1,xz:0,del:1,visible2:!1,checkAll:!1,check:!1,cardList:[],selectArr:[],skuAttr:[],colorIndex:0,orderIndex:0,sku:{goods:{},sku:{}}}},methods:{handleToggle:function(t){this.visible=t},toOpen:function(t){this[t]=!0},toClose:function(t){this[t]=!1},toHome:function(){r.a.switchTab({url:"/pages/home/home"})},editOrder:function(t){this.orderIndex=t;var s=this.cardList[t];this.sku={goods:{image:s.image,name:s.name,sellPrice:s.sellPrice},sku:s.skuAttr,skuList:s.skuList},this.handleToggle(!0)},handleUpdate:function(t,s){var e=this;return c()(a.a.mark(function i(){var n,c,l,u,d;return a.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=e.sku.skuList,c=[],t.forEach(function(t,e){var i=s[e];t.sizeArray.forEach(function(s,e){var a={num:s.sizeNum-i.sizeArray[e].sizeNum},r=t.color+","+s.sizeId;n.forEach(function(t){t.attrIds===r&&(a.skuId=t.skuId)}),c.push(a)})}),r.a.showLoading({title:"更新中"}),i.next=6,o.a.addGoodsCard({goodsCard:c});case 6:l=i.sent,u=l.code,l.data,d=l.desc,r.a.hideLoading(),1===u?(r.a.showToast({title:"修改成功",icon:"none",duration:3e3}),setTimeout(function(){e.getCard()},3e3)):r.a.showToast({title:d,icon:"none"});case 12:case"end":return i.stop()}},i,e)}))()},delBtn:function(){},clickCheck:function(t,s){if(this.cardList[s].check){this.count--,this.cardList[s].check=!1;for(var e=0;e<this.selectArr.length;e++)this.selectArr[e].id===t&&this.selectArr.splice(e,1)}else this.count++,this.cardList[s].check=!0,this.selectArr.push({id:t})},clickCheckAll:function(){var t=this;t.selectArr=[],t.checkAll?(t.checkAll=!1,t.cardList.forEach(function(t){t.check=!1}),t.count=0):(t.checkAll=!0,t.cardList.forEach(function(s){s.check=!0,t.selectArr.push({id:s.id})}),t.count=t.selectArr.length)},deleteBtn:function(){var t=this;this.selectArr.length>0?r.a.showModal({title:"删除商品",content:"确定要删除该商品么？",success:function(s){s.confirm&&t.delCard()}}):this.showToast("请选择要删除的商品")},delCard:function(t){var s=this;return c()(a.a.mark(function t(){var e,i,n,c,l;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=[],(e=s).selectArr.forEach(function(t){i.push(t.id)}),r.a.showLoading(),t.next=6,o.a.deleteCard({ids:i.join(",")});case 6:if(n=t.sent,r.a.hideLoading(),1===n.code){for(s.showToast("删除成功"),c=0;c<i.length;c++)for(l=0;l<e.selectArr.length;l++)i[c]===e.selectArr[l].id&&e.selectArr.splice(l,1);i.forEach(function(t){var e=s.cardList.findIndex(function(s){return s.id===t});s.cardList.splice(e,1)}),s.cardList.length||(s.kong=!0)}else s.showToast(n.data);case 9:case"end":return t.stop()}},t,s)}))()},Buy:function(){var t=this;this.selectArr.length>0?function(){for(var s=[],e=0,i=0,a=[],n=0;n<t.selectArr.length;n++)for(var c=0;c<t.cardList.length;c++)if(t.selectArr[n].id===t.cardList[c].id){var o=t.cardList[c].disPrice||t.cardList[c].sellPrice,l=t.cardList[c].totalNum;e+=Math.floor(o*l*100)/100,i+=l,t.cardList[c].skuList.forEach(function(t){a.push({id:t.id})}),s.push(t.cardList[c])}var u={goods:s,skuList:a,totalPrice:e.toFixed(2),totalNum:i};r.a.setStorageSync("cart",u),t.$router.push({path:"/pages/shopping/order/order"})}():this.showToast("请选择商品")},getCard:function(){var t=this;return c()(a.a.mark(function s(){var e,i,n,c,l,u,d,h,v,k,f,_,p,g,m,C,A,x,b,z,w,y,L,N,I,T;return a.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e=t,r.a.showLoading({title:"努力加载中"}),s.next=4,o.a.getCardList();case 4:if(i=s.sent,r.a.hideLoading(),1!==i.code){s.next=93;break}if(!(n=i.data)||!n.length){s.next=91;break}e.kong=!1,c=0;case 11:if(!(c<n.length)){s.next=87;break}n[c].check=!1,l=n[c].skuList,u=[],d=0;case 16:if(!(d<l.length)){s.next=46;break}h=l[d],v={},k=h.attrIds.split(","),f=h.skuCode.split(","),v.color=k[0],v.colorVal=f[0],_=[],(p={}).sizeId=k[1],p.sizeVal=f[1],p.sizeNum=h.num,p.newNum=h.num,p.editNum=0,_.push(p),v.sizeArray=_,g=!1,m=0;case 34:if(!(m<u.length)){s.next=42;break}if(u[m].color!==v.color){s.next=39;break}return u[m].sizeArray.push(p),g=!0,s.abrupt("break",42);case 39:m++,s.next=34;break;case 42:g||u.push(v);case 43:d++,s.next=16;break;case 46:n[c].skuAttr=u,C=[],A=0,x=0;case 50:if(!(x<u.length)){s.next=82;break}b=0,z=0;case 53:if(!(z<u[x].sizeArray.length)){s.next=78;break}if({},0!==u[x].sizeArray[z].sizeNum){s.next=57;break}return s.abrupt("continue",75);case 57:w=u[x].colorVal,y=u[x].sizeArray[z].sizeVal,L=u[x].sizeArray[z].sizeNum,A+=Number(L),b+=Number(L),N=!1,I="",T=0;case 65:if(!(T<C.length)){s.next=74;break}if(C[T].substring(0,1)!==w){s.next=71;break}return C[T]+=y+"/"+L+"件;",N=!0,s.abrupt("break",74);case 71:T++,s.next=65;break;case 74:N||(I=w+": "+y+"/"+L+"件;",C.push(I));case 75:z++,s.next=53;break;case 78:u[x].sizeNums=b;case 79:x++,s.next=50;break;case 82:n[c].skuCode=C,n[c].totalNum=A;case 84:c++,s.next=11;break;case 87:t.selectArr.forEach(function(t){n=n.map(function(s){return s.id===t.id&&(s.check=!0),s})}),t.cardList=n,s.next=93;break;case 91:t.cardList=[],t.selectArr=[];case 93:case"end":return s.stop()}},s,t)}))()},showToast:function(t){r.a.showToast({title:t,icon:"none",duration:1500})}},onShow:function(){this.getCard()},mounted:function(){var t=this;return c()(a.a.mark(function s(){return a.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.a.getStorageSync("shopName");case 2:t.shopName=s.sent,u.a.$on("pay-success",function(){t.selectArr=[]});case 4:case"end":return s.stop()}},s,t)}))()},onUnload:function(){u.a.$off("pay-success")},watch:{selectArr:{handler:function(){var t=this.cardList.length,s=this.selectArr.length;this.checkAll=t>0&&s>0&&s===t},deep:!0}}}},uJxD:function(t,s,e){"use strict";var i=e("Ygzb"),a=e("P8b3");var n=function(t){e("Mydx")},c=e("ybqe")(i.a,a.a,n,null,null);s.a=c.exports}},["uMe1"]);