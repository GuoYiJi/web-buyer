global.webpackJsonp([6],{"CE//":function(n,e,t){"use strict";var r={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"home"},[t("div",{staticClass:"login"},[n.userInfo.userInfo?t("p",[t("img",{staticClass:"icon_wx",attrs:{src:n.userInfo.userInfo.avatarUrl}})]):t("p",[t("i",{staticClass:"icon_wx"})],1),n._v(" "),t("p",[n._v(n._s(n.userInfo.userInfo?n.userInfo.userInfo.nickName:"微信登陆"))])],1),n._v(" "),t("i-message",{attrs:{id:"message",mpcomid:"0"}}),n._v(" "),n.userInfoBool?n._e():t("button",{staticClass:"user_btn wx_btn",attrs:{"open-type":"getUserInfo",eventid:"0"},on:{getuserinfo:n.getUserInfo}},[n._v("授权登陆")])],1)},staticRenderFns:[]};e.a=r},L8XK:function(n,e,t){"use strict";var r=t("Xxa5"),a=t.n(r),o=t("exGp"),s=t.n(o),i=t("qTHA"),c=t("90m7"),u=(t("QmSG"),t("O3Fp"));e.a={mixins:[c.a],components:{},data:function(){return{userInfoBool:!1,userInfo:{},code:""}},computed:{showBtn:function(){return this.userInfoBool}},methods:{getPhoneNumber:function(n){var e=this;return s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.mp.detail.encryptedData){t.next=4;break}e.handleError("需要同意授权才可以使用噢！"),t.next=10;break;case 4:return t.next=6,i.a.getStorageSync("production_sessionId");case 6:if(!t.sent){t.next=9;break}return t.abrupt("return",e.toRoute("home/home"));case 9:e.login(n.mp.detail);case 10:case"end":return t.stop()}},t,e)}))()},getUserInfo:function(n){n.mp.detail.encryptedData?(this.userInfoBool=!0,this.userInfo=n.mp.detail,this.login()):this.handleError("需要同意授权才可以使用噢！")},login:function(n){var e=this;return s()(a.a.mark(function n(){var t;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.a.authLogin({code:e.code,avatar:e.userInfo.userInfo.avatarUrl,nick:e.userInfo.userInfo.nickName,encryptedData:e.userInfo.encryptedData,iv:e.userInfo.iv});case 2:return t=n.sent,i.a.setStorage({key:"no",data:t.data.no}),n.next=6,i.a.setStorageSync("production_sessionId",t.data.sessionId);case 6:i.a.reLaunch({url:"/pages/home/home"});case 7:case"end":return n.stop()}},n,e)}))()}},mounted:function(){var n=this;return s()(a.a.mark(function e(){var t;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n,i.a.login({success:function(){var e=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.code?(n.code=t.code,i.a.getUserInfo({success:function(e){n.userInfoBool=!0,n.userInfo=e,n.login()},fail:function(n){}})):console.log("登录失败！"+t.errMsg);case 1:case"end":return e.stop()}},e,n)}));return function(n){return e.apply(this,arguments)}}(),fail:function(){t.handleError("授权失败！")}});case 2:case"end":return e.stop()}},e,n)}))()}}},O3Fp:function(n,e,t){"use strict";var r=t("Zrlr"),a=t.n(r),o=t("g8SW");e.a=new function n(){a()(this,n),this.authLogin=function(n){return o.a.post("api/account/userLogin",n)}}},g8SW:function(n,e,t){"use strict";var r=t("Xxa5"),a=t.n(r),o=t("//Fk"),s=t.n(o),i=t("exGp"),c=t.n(i),u=t("QmSG"),f=t("5nAL"),d=t.n(f),p=t("qTHA"),l=t("mw3O"),h=t.n(l),g=(u.a.url,u.a.url);new d.a;e.a={post:function(n){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c()(a.a.mark(function r(){var o;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.getStorageSync("production_sessionId");case 2:return o=r.sent,console.log("value jsong",o),o&&(t.sessionId=o),t.appId=u.a.appId,r.abrupt("return",new s.a(function(){var r=c()(a.a.mark(function r(o,s){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{p.a.request({url:g+"/"+n,data:h.a.stringify(t),header:{"content-type":"application/x-www-form-urlencoded"},method:"POST",success:function(n){var e=Number(n.data.code);if(1===e)o(n.data);else if(2===e)p.a.showToast({title:"登录过期，请重新登录",icon:"none",duration:2e3}),p.a.setStorageSync("production_sessionId",""),console.log(this),setTimeout(function(){p.a.reLaunch({url:"/pages/home/login"})},2e3);else if(0===e){var t=n.data.desc;p.a.showToast({title:""+t,icon:"none",duration:2e3})}}})}catch(n){console.log(n)}case 1:case"end":return e.stop()}},r,e)}));return function(n,e){return r.apply(this,arguments)}}()));case 7:case"end":return r.stop()}},r,e)}))()}}},gGg4:function(n,e){},qKiT:function(n,e,t){"use strict";var r=t("L8XK"),a=t("CE//");var o=function(n){t("gGg4")},s=t("ybqe")(r.a,a.a,o,"data-v-52f9708e",null);e.a=s.exports}},["hT9K"]);