global.webpackJsonp([11],{IjsX:function(e,t){},kYFs:function(e,t,s){"use strict";var i=s("Xxa5"),a=s.n(i),n=s("woOf"),o=s.n(n),r=s("exGp"),c=s.n(r),l=s("qTHA"),u=s("xzGo"),d=s("QmSG");t.a={data:function(){return{orderId:"",type:"",freight:"",price:"",isCheck:0,orderRefundId:"",reasonList:[{id:1,text:"不喜欢/不想要"},{id:2,text:"未按约定时间发货"},{id:3,text:"空包裹"},{id:4,text:"快递/物流未送达"}],img1:"",img2:"",img3:"",reason:"",wellShow:!1,wellMsgShow:!1,msg:"",userType:1,explain:""}},components:{},methods:{check:function(e,t){this.isCheck=e,this.reason=t,this.wellShow=!1,this.userType=this.reasonList[e].id},chooseImg:function(e){var t=this;l.a.chooseImage({count:1,success:function(s){console.log(s),t.uploadImg(s.tempFilePaths[0],function(s){t.img=s,1===e&&(t.img1=s),2===e&&(t.img2=s),3===e&&(t.img3=s)})}})},uploadImg:function(e,t){var s=e.lastIndexOf("/")+1,i=this;console.log(e.slice(s).toString(),"sdf"),l.a.showLoading({title:"上传中"}),l.a.uploadFile({url:d.a.uploadImageUrl,filePath:e,name:"file",formData:{name:e.slice(s).toString(),key:"img/${filename}",policy:d.a.imgPolicy,OSSAccessKeyId:d.a.OSSAccessKeyId,success_action_status:"200",signature:d.a.imgSignature},success:function(a){if(console.log(a),400===a.statusCode)i.mySetTimeout("图片大小不能超过2m!");else if(200===a.statusCode){if(i.maxNum&&i.imgList.length>=i.maxNum)return void i.mySetTimeout("不能超过3张图片噢！");t(d.a.uploadImageUrl+"/img/"+e.slice(s).toString())}},fail:function(e){console.log(e)},complete:function(e){l.a.hideLoading()}})},closeImg:function(e,t){this.$set(this,e,""),this[e]=""},submit:function(){var e=this;return c()(a.a.mark(function t(){var s,i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==e.explain){t.next=3;break}return e.mySetTimeout("请填写退款说明!"),t.abrupt("return",!1);case 3:if(s={orderId:e.orderId,refundType:e.type,content:e.explain,img1:e.img1,img2:e.img2,img3:e.img3,type:e.userType},i=void 0,l.a.showLoading(),!e.orderRefundId){t.next=13;break}return o()(s,{orderRefundId:e.orderRefundId}),t.next=10,u.a.updateRefund(s);case 10:i=t.sent,t.next=16;break;case 13:return t.next=15,u.a.retreatGoods(s);case 15:i=t.sent;case 16:l.a.hideLoading(),1===i.code?e.orderRefundId?(l.a.setStorageSync("update",!0),e.$router.back()):(l.a.setStorageSync("refundSuccess",!0),console.log(e.type),2==e.type?(console.log("data",i),e.$router.replace({path:"/pages/refund/barterDetails",query:{id:i.data.id}})):e.$router.replace({path:"/pages/refund/refundDetails",query:{id:i.data.id}})):l.a.showToast({title:i.desc,icon:"none",duration:1500});case 18:case"end":return t.stop()}},t,e)}))()},mySetTimeout:function(e){var t=this;t.wellMsgShow=!0,t.msg=e,setTimeout(function(){t.wellMsgShow=!1,t.msg=""},1e3)}},mounted:function(){var e=this;console.log(this.$route.query);var t=this.$route.query,s=t.orderRefundId,i=(t.orderId,t.explain),a=t.userType,n=t.img1,o=t.img2,r=t.img3;this.img1=n,this.img2=o,this.img3=r,this.explain=i,s&&(this.orderRefundId=s),this.orderId=this.$route.query.orderId,this.userType=a||1,this.isCheck=this.userType;var c=this.reasonList.findIndex(function(t){return t.id==e.userType});switch(-1!==c&&(this.reason=this.reasonList[c].text),this.type=this.$route.query.type,this.price=Number(this.$route.query.price),this.freight=Number(this.$route.query.freight),this.type){case 0:l.a.setNavigationBarTitle({title:"仅退款"})}if(this.$route.query.data){var u=JSON.parse(this.$route.query.data);this.explain=u.content,this.img1=u.img1,this.img2=u.img2,this.img3=u.img3}1===this.type&&(this.price-=this.freight,this.isRefund=!1)},onUnload:function(){o()(this,this.$options.data())}}},nWeP:function(e,t,s){"use strict";var i=s("kYFs"),a=s("wbF5");var n=function(e){s("IjsX")},o=s("ybqe")(i.a,a.a,n,"data-v-cdc7a8ac",null);t.a=o.exports},wbF5:function(e,t,s){"use strict";var i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wrapper"},[0==e.type?s("p",{staticClass:"refundReason",attrs:{eventid:"0"},on:{click:function(t){e.wellShow=!0}}},[e._v("退款原因"),s("span",{staticClass:"reason"},[e._v(e._s(e.reason))])]):e._e(),e._v(" "),1==e.type?s("p",{staticClass:"refundReason",attrs:{eventid:"1"},on:{click:function(t){e.wellShow=!0}}},[e._v("退货原因"),s("span",{staticClass:"reason"},[e._v(e._s(e.reason))])]):e._e(),e._v(" "),s("p",{staticClass:"refundPrice"},[e._v("\n    退款金额："),s("span",{staticClass:"price"},[e._v("￥"+e._s(e.price))]),e._v(" "),0==e.type?s("span",{staticClass:"freight"},[e._v("含邮费 ￥"+e._s(e.freight))]):e._e(),e._v(" "),1==e.type?s("span",{staticClass:"freight"},[e._v("不含邮费 ￥"+e._s(e.freight))]):e._e()]),e._v(" "),s("div",{staticClass:"refundExplain"},[s("p",{staticClass:"title"},[e._v(e._s(0==e.type?"退款说明":"退货说明")+"：")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.explain,expression:"explain"}],staticClass:"explain",attrs:{name:"",id:"",maxlength:"50",placeholder:"(最多可输入50个字)",eventid:"2"},domProps:{value:e.explain},on:{input:function(t){t.target.composing||(e.explain=t.target.value)}}})],1),e._v(" "),1==e.type?s("div",{staticClass:"refundVoucher"},[s("p",{staticClass:"title"},[e._v("上传凭证："),s("span",[e._v("(最多可上传3张)")])]),e._v(" "),s("div",{staticClass:"images"},[s("div",{staticClass:"img",attrs:{eventid:"4"},on:{click:function(t){e.chooseImg(1)}}},[e.img1?s("img",{attrs:{src:e.img1,alt:""}}):s("img",{attrs:{src:"../../assets/img/my/upimg.png",alt:""}}),e._v(" "),e.img1?s("span",{staticClass:"close",attrs:{eventid:"3"},on:{click:function(t){t.stopPropagation(),e.closeImg("img1",e.event)}}}):e._e()]),e._v(" "),e.img1?s("div",{staticClass:"img",attrs:{eventid:"6"},on:{click:function(t){e.chooseImg(2)}}},[e.img2?s("img",{attrs:{src:e.img2,alt:""}}):s("img",{attrs:{src:"../../assets/img/my/upimg.png",alt:""}}),e._v(" "),e.img2?s("span",{staticClass:"close",attrs:{eventid:"5"},on:{click:function(t){t.stopPropagation(),e.closeImg("img2",e.event)}}}):e._e()]):e._e(),e._v(" "),e.img2?s("div",{staticClass:"img",attrs:{eventid:"8"},on:{click:function(t){e.chooseImg(3)}}},[e.img3?s("img",{attrs:{src:e.img3,alt:""}}):s("img",{attrs:{src:"../../assets/img/my/upimg.png",alt:""}}),e._v(" "),e.img3?s("span",{staticClass:"close",attrs:{eventid:"7"},on:{click:function(t){t.stopPropagation(),e.closeImg("img3",e.event)}}}):e._e()]):e._e()])],1):e._e(),e._v(" "),s("div",{staticClass:"submit",attrs:{eventid:"9"},on:{click:e.submit}},[e._v("提交")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.wellShow,expression:"wellShow"}],staticClass:"well"},[s("div",{staticClass:"box"},[0==e.type?s("p",{staticClass:"head"},[e._v("请选择退款原因")]):e._e(),e._v(" "),1==e.type?s("p",{staticClass:"head"},[e._v("请选择退货原因")]):e._e(),e._v(" "),e._l(e.reasonList,function(t,i){return s("p",{key:i,staticClass:"select",attrs:{eventid:"10-"+i},on:{click:function(s){e.check(t.id,t.text)}}},[s("span",{staticClass:"check",class:{checked:e.isCheck==t.id}}),e._v(" "),s("span",[e._v(e._s(t.text))])])})],2)]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.wellMsgShow,expression:"wellMsgShow"}],staticClass:"wellMsg"},[e._v("\n    "+e._s(e.msg)+"\n  ")])],1)},staticRenderFns:[]};t.a=i}},["emt2"]);